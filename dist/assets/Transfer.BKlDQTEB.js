import{m as $,r as c,z as P,o as W,f as u,c as F,a as b,h as e,F as A,g as B,t as a,Q as O,O as R,R as H,j as I,N as Q,e as n,n as L}from"./vendor.BJKvz4Yw.js";import{b as U,d as q}from"./index.DnUnV9d6.js";import{_ as G}from"./MobileNav.CRat4cih.js";import{_ as J}from"./DesktopNav.BGZcsY3O.js";import{g as K}from"./coinLogos.gwK95kos.js";const X={class:"min-h-screen"},Y={class:"md:flex"},Z={class:"flex-1 pb-16 md:pb-0"},ee={class:"glass-card-no-hover border-b border-white/10 px-4 py-3"},te={class:"flex items-center justify-between"},se={class:"flex items-center gap-3"},oe={class:"p-4 space-y-4"},le={class:"flex gap-2"},ae=["onClick"],ne={class:"px-4 py-3 glass-input rounded-lg text-white/90"},re={class:"flex items-center gap-3"},ie=["src","alt"],ue={key:1,class:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center text-[11px] text-white/70"},ce={class:"text-left"},de={class:"text-sm font-medium text-white"},ve={class:"text-[11px] text-white/60"},fe={class:"flex items-center justify-between mb-1.5"},pe={class:"flex items-center gap-2"},xe={class:"text-xs text-white/50"},me={class:"text-white font-medium"},he=["disabled"],we={class:"glass-card rounded-t-lg md:rounded-lg w-full max-w-md animate-slide-up max-h-[80vh] overflow-y-auto"},be={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-3 flex justify-between items-center"},ge={class:"p-3 space-y-2"},ye=["onClick"],ke={class:"flex items-center gap-3"},_e=["src","alt"],Ce={key:1,class:"w-7 h-7 rounded-full bg-white/10 flex items-center justify-center text-xs text-white/70"},Me={class:"text-left"},Te={class:"text-sm font-medium text-white"},je={class:"text-[11px] text-white/60"},$e={key:0,class:"w-5 h-5 text-teal-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ne={__name:"Transfer",setup(Fe){Q();const{showSuccess:S,showError:g,showWarning:_}=q(),C=$(()=>window.innerWidth<768),y=c([]),p=c(!1),i=c("spot"),x=c("contract"),l=c("USDT"),d=c(""),v=c(!1),N=[{value:"spot",label:"Spot account"},{value:"contract",label:"Contract account"}],E=["USDT","BTC","ETH"];P(i,o=>{x.value=o==="spot"?"contract":"spot"});const m=$(()=>{if(!i.value||!l.value)return 0;const o=i.value.toLowerCase(),t=l.value.toUpperCase(),s=y.value.find(w=>(w.account_type||"spot").toLowerCase()===o&&(w.currency||"").toUpperCase()===t);if(!s)return 0;const r=Math.max(0,parseFloat(s.balance||0)),k=Math.max(0,parseFloat(s.locked_balance||0));return Math.max(0,r-k)}),M=o=>{if(!i.value||!o)return 0;const t=i.value.toLowerCase(),s=o.toUpperCase(),r=y.value.find(j=>(j.account_type||"spot").toLowerCase()===t&&(j.currency||"").toUpperCase()===s);if(!r)return 0;const k=Math.max(0,parseFloat(r.balance||0)),w=Math.max(0,parseFloat(r.locked_balance||0));return Math.max(0,k-w)},D=o=>{l.value=o,v.value=!1,d.value=""},f=o=>{const t=Number(o)||0;return(Math.floor(t*1e8)/1e8).toFixed(8).replace(/0+$/,"").replace(/\.$/,"")||"0"},h=o=>K(o)||"",V=()=>{d.value=f(m.value)},T=async()=>{try{const o=await U.get("/wallet");y.value=(o.data.wallets||[]).map(t=>({...t,account_type:t.account_type||"spot"}))}catch(o){console.error("Error loading wallets:",o),g("Failed to load wallets")}},z=async()=>{var t,s;const o=parseFloat(d.value);if(!o||o<=0){_("Please enter a valid amount");return}if(i.value===x.value){_("Cannot transfer to the same account");return}if(o>m.value){g(`Insufficient balance. Available: ${f(m.value)} ${l.value}`);return}p.value=!0;try{await U.post("/wallet/transfer",{from:i.value,to:x.value,currency:l.value,amount:o}),S("Transfer successful!"),d.value="",await T()}catch(r){console.error("Transfer failed:",r),g(((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.error)||"Transfer failed")}finally{p.value=!1}};return W(()=>{T()}),(o,t)=>(n(),u("div",X,[C.value?(n(),F(G,{key:0})):b("",!0),e("div",Y,[C.value?b("",!0):(n(),F(J,{key:0})),e("main",Z,[e("div",ee,[e("div",te,[e("div",se,[e("button",{onClick:t[0]||(t[0]=s=>o.$router.back()),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors"},[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t[6]||(t[6]=e("h1",{class:"text-lg font-bold text-white"},"Transfer",-1))])])]),e("div",oe,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-xs text-white/70 mb-1.5"},"From",-1)),e("div",le,[(n(),u(A,null,B(N,s=>e("button",{key:s.value,onClick:r=>i.value=s.value,class:L(["flex-1 py-2.5 px-3 rounded-lg text-sm font-medium border transition-colors",i.value===s.value?"bg-teal-500/20 text-teal-300 border-teal-400/60":"bg-white/5 text-white/70 border-white/10 hover:bg-white/10"])},a(s.label),11,ae)),64))])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-xs text-white/70 mb-1.5"},"To",-1)),e("div",ne,a(x.value==="spot"?"Spot account":"Contract account"),1),t[9]||(t[9]=e("p",{class:"text-xs text-white/50 mt-1.5"},"Automatically set based on source account",-1))]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-xs text-white/70 mb-1.5"},"Currency",-1)),e("button",{onClick:t[1]||(t[1]=s=>v.value=!0),class:"w-full px-4 py-3 glass-input rounded-lg flex items-center justify-between hover:bg-white/10 transition-colors"},[e("div",re,[h(l.value)?(n(),u("img",{key:0,src:h(l.value),alt:l.value,class:"w-6 h-6 object-contain"},null,8,ie)):(n(),u("div",ue,a(l.value),1)),e("div",ce,[e("div",de,a(l.value),1),e("div",ve," Available: "+a(f(M(l.value)))+" "+a(l.value),1)])]),t[10]||(t[10]=e("svg",{class:"w-5 h-5 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),e("div",null,[e("div",fe,[t[13]||(t[13]=e("label",{class:"block text-xs text-white/70"},"Amount",-1)),e("div",pe,[e("span",xe,[t[12]||(t[12]=R(" Available: ",-1)),e("span",me,a(f(m.value))+" "+a(l.value),1)]),e("button",{onClick:V,class:"px-2 py-0.5 text-xs glass-button rounded text-white hover:bg-white/20 transition-colors"}," Max ")])]),O(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),type:"number",step:"0.00000001",class:"w-full px-4 py-3 glass-input rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500/50 text-white placeholder-white/50",placeholder:"Enter amount"},null,512),[[H,d.value]])]),e("button",{onClick:z,disabled:p.value,class:"w-full py-3 glass-button rounded-lg text-sm font-medium text-white hover:bg-white/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},a(p.value?"Processing...":"Transfer"),9,he)]),v.value?(n(),u("div",{key:0,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[4]||(t[4]=I(s=>v.value=!1,["self"]))},[e("div",we,[e("div",be,[t[15]||(t[15]=e("h2",{class:"text-base font-bold text-white"},"Select Currency",-1)),e("button",{onClick:t[3]||(t[3]=s=>v.value=!1),class:"text-white/70 hover:text-white"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ge,[(n(),u(A,null,B(E,s=>e("button",{key:s,onClick:r=>D(s),class:L(["w-full px-4 py-3 rounded-lg flex items-center justify-between transition-colors",l.value===s?"bg-teal-500/20 border border-teal-400/60":"bg-white/5 border border-white/10 hover:bg-white/10"])},[e("div",ke,[h(s)?(n(),u("img",{key:0,src:h(s),alt:s,class:"w-7 h-7 object-contain"},null,8,_e)):(n(),u("div",Ce,a(s),1)),e("div",Me,[e("div",Te,a(s),1),e("div",je," Available: "+a(f(M(s)))+" "+a(s),1)])]),l.value===s?(n(),u("svg",$e,[...t[16]||(t[16]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):b("",!0)],10,ye)),64))])])])):b("",!0)])])]))}};export{Ne as default};
