import{m as F,r as i,z as he,o as pe,i as me,f as r,c as te,a as x,h as e,t as o,v as b,n as se,F as P,O as W,Q as le,R as oe,j as H,k as we,g as q,e as n}from"./vendor.BJKvz4Yw.js";import{u as be,b as M,d as ge}from"./index.DnUnV9d6.js";import{_ as ke}from"./MobileNav.CRat4cih.js";import{_ as ye}from"./DesktopNav.BGZcsY3O.js";import{g as _e}from"./coinLogos.gwK95kos.js";const Ce={class:"min-h-screen"},je={class:"md:flex"},Te={class:"flex-1 pb-16 md:pb-0"},Be={class:"glass-card-no-hover border-b border-white/10 px-4 py-3"},$e={class:"flex items-center justify-between"},Fe={class:"flex items-center gap-3"},Me={class:"text-lg font-bold text-white"},Ee={class:"px-4 pt-3 pb-1 flex justify-end"},Se={class:"inline-flex rounded-full bg-white/10 p-0.5 text-xs"},Ue={class:"p-4 space-y-6"},De={class:"flex items-center justify-between mb-2"},Ie={class:"text-xs text-white/60"},Le={class:"text-xs text-white/60"},Pe={key:0,class:"inline-block h-3 w-24 rounded bg-white/10 animate-pulse"},He={class:"flex items-center justify-between gap-4"},Ne=["src","alt"],Ve={class:"text-white font-semibold text-lg flex items-center gap-1"},ze={class:"flex-1 flex items-center gap-2 justify-end"},Ae={class:"flex items-center justify-between mb-2"},We={class:"text-xs text-white/60"},qe={class:"flex items-center justify-between gap-4 mb-2"},Re=["src","alt"],Oe={class:"text-white font-semibold text-lg flex items-center gap-1"},Qe={class:"flex-1 flex justify-end"},Ge={class:"flex items-center justify-end gap-2 text-sm text-white/60"},Je={key:0,class:"w-4 h-4 animate-spin text-white/60",fill:"none",viewBox:"0 0 24 24"},Ke=["disabled"],Xe={class:"w-full min-h-[50vh] max-h-[85vh] bg-[#050816]/95 rounded-t-2xl px-6 pt-6 pb-8 space-y-6 shadow-lg border-t border-white/10 animate-slide-up"},Ye={class:"flex items-center justify-between mb-4"},Ze=["disabled"],et={class:"space-y-6 text-sm text-white/80"},tt={class:"flex items-center justify-between"},st={class:"flex items-center gap-2"},lt=["src","alt"],ot={class:"font-medium text-base"},nt={class:"font-semibold text-base"},at={class:"mt-2 text-xs text-white/60"},it={class:"pt-1"},rt={class:"flex items-center justify-between"},ut={class:"flex items-center gap-2"},dt=["src","alt"],ct={class:"font-medium text-base"},vt={class:"font-semibold text-base"},ft={class:"pt-4"},xt=["disabled"],ht={key:0},pt={key:1},mt={key:2},wt={class:"glass-card rounded-t-xl md:rounded-xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},bt={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},gt={class:"p-2"},kt=["onClick"],yt={class:"flex items-center gap-3"},_t=["src","alt"],Ct={class:"flex flex-col gap-0.5"},jt={class:"text-white font-medium text-left"},Tt={class:"text-[11px] text-white/60 text-left"},Bt={key:0,class:"w-5 h-5 text-blue-400 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$t={class:"glass-card rounded-t-xl md:rounded-xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},Ft={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},Mt={class:"p-2"},Et=["onClick"],St={class:"flex items-center gap-3"},Ut=["src","alt"],Dt={class:"flex flex-col gap-0.5"},It={class:"text-white font-medium text-left"},Lt={class:"text-[11px] text-white/60 text-left"},Pt={key:0,class:"w-5 h-5 text-blue-400 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ht={class:"glass-card rounded-t-xl md:rounded-xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},Nt={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},Vt={class:"text-lg font-bold text-white"},zt={class:"p-4"},At={class:"flex justify-between items-start mb-2"},Wt={class:"text-white font-medium"},qt={class:"text-white/60 text-sm"},Rt={class:"text-white/70 text-sm"},Ot={key:0,class:"text-center text-white/60 py-8"},Zt={__name:"FlashExchange",setup(Qt){const{t:p}=be(),R=F(()=>window.innerWidth<768),ne=["USDT","BTC","ETH"],a=i("USDT"),u=i("BTC"),d=i(""),v=i(""),g=i("from"),m=i(!1),k=i(8),h=i(!1);let f=null;const ae=i("currency"),w=i(!1),j=i(!1),T=i(!1);i(!1);const E=i(!1),S=i([]),N=i(!0),U=i([]),{showError:B,showSuccess:ie}=ge(),O=F(()=>ne),D=F(()=>{const s=S.value.find(t=>t.currency===a.value);return s?s.balance:0}),Q=s=>{const t=S.value.find(l=>l.currency===s);return t?t.balance:0},y=s=>_e(s)||"",_=i("spot"),I=i({BTCUSDT:null,ETHUSDT:null}),V=i(!1);let L=null;const G=s=>s==="USDT"?1:s==="BTC"?I.value.BTCUSDT||null:s==="ETH"&&I.value.ETHUSDT||null,C=F(()=>{const s=G(a.value),t=G(u.value);return!s||!t?0:s/t}),J=F(()=>{if(!C.value)return"--";const s=a.value,t=u.value,l=C.value;let c;return l>=1?c=l.toFixed(2):(c=l.toFixed(8),c=c.replace(/0+$/,"").replace(/\.$/,".0")),`1 ${s} = ${c} ${t}`}),K=s=>{const t=parseFloat(s);return Number.isNaN(t)?"0.00":t>=1?t.toFixed(2):t>=.01?t.toFixed(4):t.toFixed(8)},z=s=>{const t=Number(s)||0;return(Math.floor(t*1e8)/1e8).toFixed(8).replace(/0+$/,"").replace(/\.$/,"")},re=s=>s?new Date(s).toLocaleString():"N/A",ue=s=>{s===u.value&&(u.value=a.value),a.value=s,j.value=!1,$()},de=s=>{s===a.value&&(a.value=u.value),u.value=s,T.value=!1},ce=()=>{const s=a.value;a.value=u.value,u.value=s,$()},ve=s=>{ae.value=s;{const t=Number(D.value)||0,l=Math.floor(t*1e8)/1e8;d.value=l.toString(),g.value="from"}},X=()=>{if(!C.value){v.value="";return}if(g.value==="from"){const s=parseFloat(d.value);if(!s||s<=0){v.value="";return}v.value=(s*C.value).toFixed(8)}else if(g.value==="to"){const s=parseFloat(v.value);if(!s||s<=0){d.value="";return}d.value=(s/C.value).toFixed(8)}},$=async()=>{try{S.value.length||(N.value=!0);const s=await M.get("/wallet",{params:{account_type:_.value}});S.value=s.data.wallets||[]}catch(s){console.error("Error loading wallets:",s)}finally{N.value=!1}},Y=s=>{s!==_.value&&(_.value=s,d.value="",v.value="",$())},A=async()=>{try{V.value=!0;const[s,t]=await Promise.all([M.get("/market/ticker/BTCUSDT"),M.get("/market/ticker/ETHUSDT")]),l=c=>parseFloat(c.price||c.lastPrice||c.close||0);I.value.BTCUSDT=l(s.data),I.value.ETHUSDT=l(t.data)}catch(s){console.error("Error loading prices for flash exchange:",s)}finally{V.value=!1}};he([C,a,u,d,v,g,m,h],()=>{m.value&&!h.value||X()});const Z=async()=>{try{const s=await M.get("/exchange/history").catch(()=>({data:{exchanges:[]}}));U.value=s.data.exchanges||[]}catch(s){console.error("Error loading exchange history:",s),U.value=[]}},fe=()=>{const s=parseFloat(d.value);if(!s||s<=0){B("Please enter a valid exchange quantity");return}if(s>D.value){B("Insufficient balance");return}m.value=!0,k.value=8,h.value=!1,f&&(clearInterval(f),f=null),f=setInterval(async()=>{if(k.value>0){k.value-=1;return}try{h.value=!0,await A(),X()}finally{k.value=8,h.value=!1}},1e3)},ee=()=>{m.value=!1,f&&(clearInterval(f),f=null),h.value=!1,k.value=8},xe=async()=>{var t,l;const s=parseFloat(d.value);if(!s||s<=0){B("Please enter a valid exchange quantity");return}if(s>D.value){B("Insufficient balance");return}w.value=!0;try{await M.post("/exchange",{fromCurrency:a.value,toCurrency:u.value,amount:s,accountType:_.value}),ie("Exchange completed successfully!"),d.value="",v.value="",m.value=!1,f&&(clearInterval(f),f=null),await Promise.all([$(),Z()])}catch(c){B(((l=(t=c.response)==null?void 0:t.data)==null?void 0:l.error)||"Exchange failed")}finally{w.value=!1}};return pe(()=>{$(),Z(),A(),L=setInterval(()=>{m.value||A()},3e3)}),me(()=>{L&&(clearInterval(L),L=null)}),(s,t)=>(n(),r("div",Ce,[R.value?(n(),te(ke,{key:0})):x("",!0),e("div",je,[R.value?x("",!0):(n(),te(ye,{key:0})),e("main",Te,[e("div",Be,[e("div",$e,[e("div",Fe,[e("button",{onClick:t[0]||(t[0]=l=>s.$router.back()),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors"},[...t[17]||(t[17]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e("h1",Me,o(b(p)("flashExchange.title")),1)]),e("button",{onClick:t[1]||(t[1]=l=>E.value=!0),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])])])]),e("div",Ee,[e("div",Se,[e("button",{class:se(["px-3 py-1 rounded-full transition-colors",_.value==="spot"?"bg-white text-[#0b1020] font-semibold":"text-white/70"]),onClick:t[2]||(t[2]=l=>Y("spot"))}," Spot ",2),e("button",{class:se(["px-3 py-1 rounded-full transition-colors",_.value==="contract"?"bg-white text-[#0b1020] font-semibold":"text-white/70"]),onClick:t[3]||(t[3]=l=>Y("contract"))}," Contract ",2)])]),e("div",Ue,[e("div",null,[e("div",De,[e("span",Ie,o(b(p)("flashExchange.from")),1),e("span",Le,[N.value?(n(),r("span",Pe)):(n(),r(P,{key:1},[W(" Wallets "+o(z(D.value))+" "+o(a.value),1)],64))])]),e("div",He,[e("button",{onClick:t[4]||(t[4]=l=>j.value=!0),class:"flex items-center gap-2"},[e("img",{src:y(a.value),alt:a.value,class:"w-7 h-7 object-contain flex-shrink-0"},null,8,Ne),e("span",Ve,[W(o(a.value)+" ",1),t[19]||(t[19]=e("svg",{class:"w-4 h-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),e("div",ze,[le(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>d.value=l),type:"number",step:"0.00000001",onInput:t[6]||(t[6]=l=>g.value="from"),class:"w-full max-w-[180px] bg-transparent border-b border-white/20 px-2 py-2 focus:outline-none text-white text-xl font-semibold text-right",placeholder:"0.00000000"},null,544),[[oe,d.value]]),e("button",{onClick:t[7]||(t[7]=l=>ve("all")),class:"text-xs font-semibold text-blue-300 hover:text-blue-200 transition-colors"}," Max ")])])]),e("div",{class:"flex justify-center py-2"},[e("button",{onClick:ce,class:"w-10 h-10 bg-white/10 hover:bg-white/20 rounded-lg flex items-center justify-center transition-colors"},[...t[20]||(t[20]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})],-1)])])]),e("div",null,[e("div",Ae,[e("span",We,o(b(p)("flashExchange.to")),1),t[21]||(t[21]=e("span",{class:"text-xs text-transparent select-none"},".",-1))]),e("div",qe,[e("button",{onClick:t[8]||(t[8]=l=>T.value=!0),class:"flex items-center gap-2"},[e("img",{src:y(u.value),alt:u.value,class:"w-7 h-7 object-contain flex-shrink-0"},null,8,Re),e("span",Oe,[W(o(u.value)+" ",1),t[22]||(t[22]=e("svg",{class:"w-4 h-4 text-white/60",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),e("div",Qe,[le(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>v.value=l),type:"number",step:"0.00000001",onInput:t[10]||(t[10]=l=>g.value="to"),class:"w-full max-w-[180px] bg-transparent border-b border-white/20 px-2 py-2 focus:outline-none text-white text-xl font-semibold text-right",placeholder:"0.00000000"},null,544),[[oe,v.value]])])]),e("div",Ge,[V.value?(n(),r("svg",Je,[...t[23]||(t[23]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)])])):x("",!0),e("span",null,o(J.value),1)])]),e("button",{onClick:fe,disabled:w.value||!d.value||parseFloat(d.value)<=0,class:"w-full mt-6 py-3 rounded-lg font-semibold text-base transition-all disabled:opacity-50 disabled:cursor-not-allowed glass-button-no-hover text-white"},o(w.value?b(p)("common.processing"):"Preview"),9,Ke)])])]),m.value?(n(),r("div",{key:1,class:"fixed inset-0 z-50 flex items-end bg-black/50",onClick:H(ee,["self"])},[e("div",Xe,[e("div",Ye,[t[25]||(t[25]=e("h2",{class:"text-base font-semibold text-white"},"Confirm Order",-1)),e("button",{class:"p-1 rounded-full hover:bg-white/10 text-white/70",onClick:ee,disabled:w.value},[...t[24]||(t[24]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ze)]),e("div",et,[e("div",null,[t[26]||(t[26]=e("div",{class:"text-xs text-white/60 mb-1.5"},"From",-1)),e("div",tt,[e("div",st,[e("img",{src:y(a.value),alt:a.value,class:"w-7 h-7 object-contain"},null,8,lt),e("span",ot,o(a.value),1)]),e("span",nt,o(d.value||"0"),1)]),e("div",at,o(J.value),1)]),e("div",it,[t[27]||(t[27]=e("div",{class:"text-xs text-white/60 mb-1.5"},"To",-1)),e("div",rt,[e("div",ut,[e("img",{src:y(u.value),alt:u.value,class:"w-7 h-7 object-contain"},null,8,dt),e("span",ct,o(u.value),1)]),e("span",vt,o(v.value||"0"),1)])]),t[28]||(t[28]=we('<div class="pt-2 space-y-2 border-t border-white/10 mt-1 pt-3"><div class="flex items-center justify-between text-xs text-white/70"><span>Type</span><span class="font-medium text-white">Instant</span></div><div class="flex items-center justify-between text-xs text-white/70"><span>Transaction Fees</span><span class="font-medium text-white">0 USDT</span></div></div>',1))]),e("div",ft,[e("button",{class:"w-full py-3.5 rounded-lg glass-button-no-hover text-base font-semibold text-white disabled:opacity-50 disabled:cursor-not-allowed transition-colors",onClick:xe,disabled:w.value||h.value},[w.value?(n(),r("span",ht,o(b(p)("common.processing")),1)):h.value?(n(),r("span",pt," Updating... ")):(n(),r("span",mt," Confirm ( "+o(k.value)+"s ) ",1))],8,xt)])])])):x("",!0),j.value?(n(),r("div",{key:2,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[12]||(t[12]=H(l=>j.value=!1,["self"]))},[e("div",wt,[e("div",bt,[t[30]||(t[30]=e("h2",{class:"text-lg font-bold text-white"},"Select currency",-1)),e("button",{onClick:t[11]||(t[11]=l=>j.value=!1),class:"text-white/70 hover:text-white"},[...t[29]||(t[29]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",gt,[(n(!0),r(P,null,q(O.value,l=>(n(),r("button",{key:l,onClick:c=>ue(l),class:"w-full flex items-center p-4 border-b border-white/10 last:border-b-0 hover:bg-white/5 transition-colors"},[e("div",yt,[e("img",{src:y(l),alt:l,class:"w-6 h-6 object-contain"},null,8,_t),e("div",Ct,[e("span",jt,o(l),1),e("span",Tt," Wallet: "+o(z(Q(l)))+" "+o(l),1)])]),a.value===l?(n(),r("svg",Bt,[...t[31]||(t[31]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):x("",!0)],8,kt))),128))])])])):x("",!0),T.value?(n(),r("div",{key:3,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[14]||(t[14]=H(l=>T.value=!1,["self"]))},[e("div",$t,[e("div",Ft,[t[33]||(t[33]=e("h2",{class:"text-lg font-bold text-white"},"Select currency",-1)),e("button",{onClick:t[13]||(t[13]=l=>T.value=!1),class:"text-white/70 hover:text-white"},[...t[32]||(t[32]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Mt,[(n(!0),r(P,null,q(O.value.filter(l=>l!==a.value),l=>(n(),r("button",{key:l,onClick:c=>de(l),class:"w-full flex items-center p-4 border-b border-white/10 last:border-b-0 hover:bg-white/5 transition-colors"},[e("div",St,[e("img",{src:y(l),alt:l,class:"w-6 h-6 object-contain"},null,8,Ut),e("div",Dt,[e("span",It,o(l),1),e("span",Lt," Wallet: "+o(z(Q(l)))+" "+o(l),1)])]),u.value===l?(n(),r("svg",Pt,[...t[34]||(t[34]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):x("",!0)],8,Et))),128))])])])):x("",!0),E.value?(n(),r("div",{key:4,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[16]||(t[16]=H(l=>E.value=!1,["self"]))},[e("div",Ht,[e("div",Nt,[e("h2",Vt,o(b(p)("flashExchange.history")),1),e("button",{onClick:t[15]||(t[15]=l=>E.value=!1),class:"text-white/70 hover:text-white"},[...t[35]||(t[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",zt,[(n(!0),r(P,null,q(U.value,l=>(n(),r("div",{key:l.id,class:"p-4 border-b border-white/10 last:border-b-0"},[e("div",At,[e("div",null,[e("div",Wt,o(l.fromCurrency)+" â†’ "+o(l.toCurrency),1),e("div",qt,o(re(l.created_at)),1)]),t[36]||(t[36]=e("span",{class:"px-2 py-1 rounded text-xs bg-green-500/20 text-green-300"}," Completed ",-1))]),e("div",Rt,o(K(l.amount_from))+" "+o(l.from_currency)+" = "+o(K(l.amount_to))+" "+o(l.to_currency),1)]))),128)),U.value.length===0?(n(),r("div",Ot,o(b(p)("flashExchange.noHistory")),1)):x("",!0)])])])):x("",!0)]))}};export{Zt as default};
