import{l as k,r as u,g as O,b as r,c as A,I as m,f as t,t as o,K as n,N as C,F as M,d as $,O as D,P as W,n as E,J as H,M as Q,o as i}from"./vendor-QOrkcOk8.js";import{u as P,a as q,b as S,d as J}from"./index-wX3mV7sr.js";import{_ as K,a as G}from"./DesktopNav-y0IF6Y0_.js";const X={class:"min-h-screen"},Y={class:"md:flex"},Z={class:"flex-1 pb-16 md:pb-0"},tt={class:"glass-card-no-hover border-b border-white/10 px-4 py-3"},et={class:"flex items-center justify-between"},st={class:"flex items-center gap-3"},ot={class:"text-lg font-bold text-white"},at={class:"p-4 space-y-4"},lt={class:"flex items-center justify-between"},nt={class:"text-white font-medium text-base"},it={key:0},rt={class:"flex gap-2"},dt=["onClick"],ut={key:1,class:"text-white/70 text-sm"},ct={class:"text-white font-medium"},wt={class:"text-white/70 text-sm mb-1"},ht={class:"flex items-center justify-between"},vt={class:"text-white text-lg font-medium"},xt={class:"text-white/70 text-sm"},mt=["placeholder"],ft={class:"text-xs text-yellow-400/80 mt-1.5"},pt={class:"text-white/70 text-sm mb-1"},_t={class:"flex items-center gap-2"},bt={class:"text-white/70 text-sm px-2"},gt={class:"text-white/70 text-sm"},yt={class:"text-white font-medium"},kt={class:"text-white/70 text-sm"},Ct={class:"text-white font-medium text-base"},Bt=["disabled"],Tt={class:"glass-card rounded-t-lg md:rounded-lg w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},jt={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},Mt={class:"text-lg font-bold text-white"},$t={class:"p-4"},Et=["onClick"],St={class:"text-white font-medium"},Ft={key:0,class:"w-5 h-5 text-teal-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={class:"glass-card rounded-t-lg md:rounded-lg w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},Dt={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},Wt={class:"text-lg font-bold text-white"},Ht={class:"p-4"},Rt={key:0,class:"text-center py-12"},Ut={class:"text-white/60"},Lt={key:1,class:"space-y-3"},Nt={class:"flex items-center justify-between mb-2"},Vt={class:"text-white font-medium"},zt={class:"text-white/70 text-xs mb-1"},It={class:"text-white/70 text-xs mb-1"},Ot={class:"text-white/70 text-xs"},R=2,Kt={__name:"Withdraw",setup(Qt){const{t:a}=P();Q(),q();const{showAlert:f}=J(),F=k(()=>window.innerWidth<768),d=u("USDT"),v=u("ERC20"),w=u(""),h=u(""),p=u(!1),b=u(!1),_=u(!1),x=u(0),g=u([]),U=["USDT","BTC","ETH"],y=k(()=>d.value==="USDT"?["ERC20","TRC20"]:d.value==="BTC"?["BTC"]:d.value==="ETH"?["ERC20"]:[]),L=k(()=>{const l=parseFloat(h.value)||0,e=l*(R/100);return Math.max(0,l-e)}),B=k(()=>{const l=parseFloat(h.value)||0;return w.value.trim().length>0&&l>0&&l<=x.value&&w.value.trim().indexOf(" ")===-1}),T=l=>{const e=parseFloat(l)||0;return e===0?"0.00000000":e<1e-5?e.toFixed(8):e<1?e.toFixed(6):e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:8})},N=l=>{d.value=l,p.value=!1,l==="USDT"?v.value="ERC20":l==="BTC"?v.value="BTC":l==="ETH"&&(v.value="ERC20"),j()},V=()=>{h.value=x.value.toString()},j=async()=>{var l;try{const s=(l=(await S.get("/wallet/balance",{params:{account_type:"spot"}})).data.balances)==null?void 0:l.find(c=>c.currency===d.value);x.value=(s==null?void 0:s.available)||0}catch(e){console.error("Error loading extractable quantity:",e),x.value=0}},z=async()=>{try{const l=await S.get("/wallet/withdrawals");g.value=l.data.withdrawals||[]}catch(l){console.error("Error loading withdraw history:",l),g.value=[]}},I=async()=>{var e,s;if(!B.value){f("error",a("withdraw.invalidInput"));return}const l=parseFloat(h.value);if(l>x.value){f("error",a("withdraw.insufficientBalance"));return}if(w.value.trim().indexOf(" ")!==-1){f("error",a("withdraw.addressWarning"));return}_.value=!0;try{await S.post("/wallet/withdraw",{currency:d.value,amount:l,address:w.value.trim(),network:v.value}),f("success",a("withdraw.success")),w.value="",h.value="",await j()}catch(c){console.error("Withdraw error:",c),f("error",((s=(e=c.response)==null?void 0:e.data)==null?void 0:s.error)||a("withdraw.error"))}finally{_.value=!1}};return O(async()=>{await j(),await z()}),(l,e)=>(i(),r("div",X,[F.value?(i(),A(K,{key:0})):m("",!0),t("div",Y,[F.value?m("",!0):(i(),A(G,{key:0})),t("main",Z,[t("div",tt,[t("div",et,[t("div",st,[t("button",{onClick:e[0]||(e[0]=s=>l.$router.back()),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors"},[...e[9]||(e[9]=[t("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("h1",ot,o(n(a)("withdraw.title")),1)]),t("button",{onClick:e[1]||(e[1]=s=>b.value=!0),class:"text-sm text-white/70 hover:text-white transition-colors"},o(n(a)("withdraw.history")),1)])]),t("div",at,[t("div",null,[t("div",lt,[t("span",nt,o(d.value),1),t("button",{onClick:e[2]||(e[2]=s=>p.value=!0),class:"flex items-center gap-1 text-sm text-white/70 hover:text-white transition-colors"},[C(o(n(a)("withdraw.selectCurrency"))+" ",1),e[10]||(e[10]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])])]),y.value.length>1?(i(),r("div",it,[t("div",rt,[(i(!0),r(M,null,$(y.value,s=>(i(),r("button",{key:s,onClick:c=>v.value=s,class:E(["flex-1 py-2.5 px-4 rounded-lg font-medium text-sm transition-colors border",v.value===s?"bg-teal-500/20 text-teal-300 border-teal-500/50":"bg-white/5 text-white/70 border-white/10 hover:bg-white/10"])},o(s),11,dt))),128))])])):y.value.length===1?(i(),r("div",ut,[C(o(n(a)("withdraw.network"))+": ",1),t("span",ct,o(y.value[0]),1)])):m("",!0),t("div",null,[t("div",wt,o(n(a)("withdraw.extractableQuantity")),1),t("div",ht,[t("span",vt,o(T(x.value)),1),t("span",xt,o(d.value),1)])]),t("div",null,[D(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>w.value=s),type:"text",class:"w-full px-4 py-3 glass-input rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-teal-500/50",placeholder:n(a)("withdraw.enterAddress")},null,8,mt),[[W,w.value]]),t("p",ft,o(n(a)("withdraw.addressWarning")),1)]),t("div",null,[t("div",pt,o(n(a)("withdraw.amount")),1),t("div",_t,[D(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>h.value=s),type:"number",step:"0.00000001",min:"0",class:"flex-1 px-4 py-3 glass-input rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-teal-500/50",placeholder:"0"},null,512),[[W,h.value]]),t("span",bt,o(d.value),1),e[11]||(e[11]=t("div",{class:"w-px h-6 bg-white/20"},null,-1)),t("button",{onClick:V,class:"text-sm text-white/70 hover:text-white transition-colors px-2"},o(n(a)("common.all")),1)])]),t("div",gt,[C(o(n(a)("withdraw.fee"))+": ",1),t("span",yt,o(R)+"% "+o(d.value),1)]),t("div",kt,[C(o(n(a)("withdraw.arrivedAmount"))+": ",1),t("span",Ct,o(T(L.value))+" "+o(d.value),1)]),t("button",{onClick:I,disabled:_.value||!B.value,class:E(["w-full py-4 rounded-lg font-bold text-white text-base transition-all",B.value&&!_.value?"bg-teal-500 hover:bg-teal-600 active:bg-teal-700":"bg-white/10 text-white/50 cursor-not-allowed"])},o(_.value?n(a)("common.processing"):n(a)("withdraw.button")),11,Bt)])])]),p.value?(i(),r("div",{key:1,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:e[6]||(e[6]=H(s=>p.value=!1,["self"]))},[t("div",Tt,[t("div",jt,[t("h2",Mt,o(n(a)("withdraw.selectCurrency")),1),t("button",{onClick:e[5]||(e[5]=s=>p.value=!1),class:"text-white/70 hover:text-white"},[...e[12]||(e[12]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",$t,[(i(),r(M,null,$(U,s=>t("div",{key:s,onClick:c=>N(s),class:"flex items-center justify-between p-3 rounded-lg hover:bg-white/5 cursor-pointer transition-colors"},[t("span",St,o(s),1),d.value===s?(i(),r("svg",Ft,[...e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):m("",!0)],8,Et)),64))])])])):m("",!0),b.value?(i(),r("div",{key:2,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:e[8]||(e[8]=H(s=>b.value=!1,["self"]))},[t("div",At,[t("div",Dt,[t("h2",Wt,o(n(a)("withdraw.history")),1),t("button",{onClick:e[7]||(e[7]=s=>b.value=!1),class:"text-white/70 hover:text-white"},[...e[14]||(e[14]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Ht,[g.value.length===0?(i(),r("div",Rt,[t("p",Ut,o(n(a)("withdraw.noHistory")),1)])):(i(),r("div",Lt,[(i(!0),r(M,null,$(g.value,(s,c)=>(i(),r("div",{key:c,class:"glass-card rounded-lg p-3"},[t("div",Nt,[t("span",Vt,o(s.currency),1),t("span",{class:E(["text-sm font-medium",s.status==="completed"?"text-green-400":s.status==="pending"?"text-yellow-400":"text-red-400"])},o(n(a)(`withdraw.status.${s.status}`)),3)]),t("div",zt,o(n(a)("withdraw.amount"))+": "+o(T(s.amount))+" "+o(s.currency),1),t("div",It,o(n(a)("withdraw.address"))+": "+o(s.address),1),t("div",Ot,o(new Date(s.created_at).toLocaleString()),1)]))),128))]))])])])):m("",!0)]))}};export{Kt as default};
