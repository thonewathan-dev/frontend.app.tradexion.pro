import{l as R,r as c,R as Y,u as E,g as G,b as i,c as F,I as h,f as e,t as r,K as v,N as X,F as j,d as A,O as Z,P as ee,J as L,o as a,n as M}from"./vendor-QOrkcOk8.js";import{u as te,b as N}from"./index-wX3mV7sr.js";import{_ as se,a as oe}from"./DesktopNav-y0IF6Y0_.js";const le={class:"min-h-screen"},re={class:"md:flex"},ne={class:"flex-1 pb-16 md:pb-0"},ae={class:"glass-card-no-hover border-b border-white/10 px-4 py-3"},ie={class:"flex items-center justify-between"},de={class:"flex items-center gap-3"},ue={class:"text-lg font-bold text-white"},ce={class:"p-4"},ve={class:"mb-4"},pe={class:"flex items-center justify-between mb-2"},he={class:"text-white font-medium"},fe={key:0,class:"mb-4"},me={class:"flex gap-2"},be=["onClick"],we={key:1,class:"glass-card rounded-xl p-6 mb-4 text-center"},xe={class:"mb-4"},ge={class:"inline-block p-4 bg-white rounded-lg relative"},_e=["src"],ye={class:"absolute inset-0 flex items-center justify-center pointer-events-none"},ke={class:"w-12 h-12 bg-white rounded-full p-2 flex items-center justify-center shadow-lg"},Ce=["src","alt"],Te={class:"mb-2"},Be={class:"text-white/70 text-sm mb-2"},De={class:"flex items-center gap-2 justify-center"},Re={class:"text-white font-mono text-sm break-all"},je={class:"glass-card rounded-xl p-4 space-y-4"},Ae={class:"block text-sm text-white/70 mb-2"},Ne={class:"flex items-center gap-2"},Se={class:"text-white/70 text-sm"},Ue={class:"block text-sm text-white/70 mb-2"},$e=["value"],Ee={key:0,class:"mt-2"},Fe=["src"],Le=["disabled"],Me={class:"text-xs text-white/60 text-center"},Ke={class:"glass-card rounded-t-xl md:rounded-xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},Pe={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},qe={class:"text-lg font-bold text-white"},He={class:"p-2"},ze=["onClick"],Ie={class:"text-white font-medium"},Ve={key:0,class:"w-5 h-5 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Je={class:"glass-card rounded-t-xl md:rounded-xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up"},Oe={class:"sticky top-0 glass-card-no-hover border-b border-white/10 p-4 flex justify-between items-center"},Qe={class:"p-4"},We={class:"flex justify-between items-start mb-2"},Ye={class:"text-white font-medium"},Ge={class:"text-white/60 text-sm"},Xe={key:0,class:"text-center text-white/60 py-8"},ot={__name:"Deposit",setup(Ze){const{t:d}=te(),K=Y(),S=R(()=>window.innerWidth<768),o=c(K.query.currency||"USDT"),u=c("TRC20"),b=c(""),f=c(null),_=c(null),p=c(""),w=c(""),y=c(!1),x=c(!1),k=c(!1),C=c([]),P=c(null),q=[{value:"BTC",label:"BTC"},{value:"USDT",label:"USDT"},{value:"ETH",label:"ETH"},{value:"BANK",label:"P2P Bank transfer"}],B=R(()=>o.value==="USDT"?["TRC20","ERC20"]:o.value==="ETH"?["ERC20"]:o.value==="BTC"?["BTC"]:[]),H=R(()=>{if(o.value==="USDT"){if(u.value==="TRC20")return new URL("/assets/USDT-TRC20-nefzOlJh.png",import.meta.url).href;if(u.value==="ERC20")return new URL("/assets/USDT-ERC20-DV68RjSM.png",import.meta.url).href}else{if(o.value==="BTC")return new URL("/assets/BTC-CUVYde77.png",import.meta.url).href;if(o.value==="ETH")return new URL("/assets/ETH-tfTyAzfy.png",import.meta.url).href}return new URL("/assets/USDT-TRC20-nefzOlJh.png",import.meta.url).href}),z=l=>{const t=parseFloat(l);return t>=1?t.toFixed(2):t>=.01?t.toFixed(4):t.toFixed(8)},I=l=>l?new Date(l).toLocaleString():"N/A",V=l=>{o.value=l,x.value=!1,T()},T=async()=>{var l,t,s,n,$;if(o.value==="BANK"){p.value="",w.value="";return}try{console.log("Loading deposit address for:",o.value,u.value);const m=await N.get("/deposit/addresses",{params:{currency:o.value,network:u.value}});console.log("Deposit address response:",m.data);const g=m.data.addresses||[];console.log("Found addresses:",g.length,g);const D=g.find(W=>W.is_active!==!1)||g[0];D&&D.address?(p.value=D.address,w.value=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(p.value)}`,console.log("Set deposit address:",p.value.substring(0,20)+"...")):(console.warn("No valid address found. Addresses array:",g),p.value="",w.value="")}catch(m){console.error("Error loading deposit address:",m),console.error("Currency:",o.value,"Network:",u.value),console.error("Error response:",(l=m.response)==null?void 0:l.data),console.error("Full error:",m),(((t=m.response)==null?void 0:t.status)===404||(($=(n=(s=m.response)==null?void 0:s.data)==null?void 0:n.addresses)==null?void 0:$.length)===0)&&console.warn(`No deposit address found for ${o.value} ${u.value}. Please contact admin.`),p.value="",w.value=""}},J=async()=>{if(p.value)try{await navigator.clipboard.writeText(p.value),alert("Address copied to clipboard!")}catch(l){console.error("Failed to copy:",l)}},O=l=>{const t=l.target.files[0];if(t){f.value=t;const s=new FileReader;s.onload=n=>{_.value=n.target.result},s.readAsDataURL(t)}},U=async()=>{var l,t,s;try{console.log("Loading deposit history...");const n=await N.get("/deposit/requests");console.log("Deposit history response:",n.data),C.value=n.data.deposits||n.data||[]}catch(n){console.error("Error loading deposit history:",n),console.error("Error response:",(l=n.response)==null?void 0:l.data),console.error("Error status:",(t=n.response)==null?void 0:t.status),console.error("Error message:",n.message),((s=n.response)==null?void 0:s.status)===401?alert("Please login again"):console.error("Failed to load deposit history"),C.value=[]}},Q=async()=>{var l,t;if(!b.value||parseFloat(b.value)<=0){alert("Please enter a valid amount");return}if(o.value!=="BANK"&&!f.value){alert("Screenshot is required for crypto deposits");return}y.value=!0;try{const s=new FormData;s.append("currency",o.value==="BANK"?"USDT":o.value),s.append("amount",b.value),s.append("deposit_type",o.value==="BANK"?"bank":"crypto"),o.value!=="BANK"&&u.value&&s.append("network",u.value),f.value&&s.append("screenshot",f.value),await N.post("/deposit/request",s,{headers:{"Content-Type":"multipart/form-data"}}),alert("Deposit request submitted successfully! Waiting for admin approval."),b.value="",f.value=null,_.value=null,U()}catch(s){alert(((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.error)||"Deposit request failed")}y.value=!1};return E(u,()=>{T()}),E(o,()=>{o.value!=="BANK"&&B.value.length>0&&(u.value=B.value[0]),T()}),G(()=>{T(),U()}),(l,t)=>(a(),i("div",le,[S.value?(a(),F(se,{key:0})):h("",!0),e("div",re,[S.value?h("",!0):(a(),F(oe,{key:0})),e("main",ne,[e("div",ae,[e("div",ie,[e("div",de,[e("button",{onClick:t[0]||(t[0]=s=>l.$router.back()),class:"p-1.5 hover:bg-white/10 rounded-lg transition-colors"},[...t[9]||(t[9]=[e("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),e("h1",ue,r(v(d)("deposit.title")),1)]),e("button",{onClick:t[1]||(t[1]=s=>k.value=!0),class:"text-sm text-white/70 hover:text-white transition-colors"},r(v(d)("deposit.history")),1)])]),e("div",ce,[e("div",ve,[e("div",pe,[e("span",he,r(o.value),1),e("button",{onClick:t[2]||(t[2]=s=>x.value=!0),class:"flex items-center gap-1 text-sm text-white/70 hover:text-white transition-colors"},[X(r(v(d)("deposit.selectCurrency"))+" ",1),t[10]||(t[10]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])])]),o.value!=="BANK"?(a(),i("div",fe,[e("div",me,[(a(!0),i(j,null,A(B.value,s=>(a(),i("button",{key:s,onClick:n=>u.value=s,class:M(["flex-1 py-2 px-4 rounded-lg font-medium transition-colors",u.value===s?"bg-blue-500/30 text-blue-200 border border-blue-500/50":"glass-input text-white/70 hover:bg-white/10"])},r(s),11,be))),128))])])):h("",!0),p.value?(a(),i("div",we,[e("div",xe,[e("div",ge,[e("img",{src:w.value,alt:"QR Code",class:"w-48 h-48"},null,8,_e),e("div",ye,[e("div",ke,[e("img",{src:H.value,alt:o.value,class:"w-full h-full object-contain"},null,8,Ce)])])])]),e("div",Te,[e("p",Be,r(v(d)("deposit.depositAddress")),1),e("div",De,[e("p",Re,r(p.value),1),e("button",{onClick:J,class:"px-3 py-1 bg-blue-500/30 text-blue-200 rounded-lg text-sm hover:bg-blue-500/40 transition-colors"},r(v(d)("deposit.copy")),1)])])])):h("",!0),e("div",je,[e("div",null,[e("label",Ae,r(v(d)("deposit.rechargeQuantity")),1),e("div",Ne,[Z(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>b.value=s),type:"number",step:"0.00000001",class:"flex-1 px-4 py-2 glass-input rounded-lg focus:outline-none",placeholder:"0.00"},null,512),[[ee,b.value]]),e("span",Se,r(o.value),1)])]),e("div",null,[e("label",Ue,r(v(d)("deposit.transferScreenshot")),1),e("input",{type:"file",accept:"image/*",onChange:O,class:"hidden",ref_key:"fileInput",ref:P},null,544),e("input",{type:"text",value:f.value?f.value.name:"Select Picture",readonly:"",onClick:t[4]||(t[4]=s=>l.$refs.fileInput.click()),class:"w-full px-4 py-2 glass-input rounded-lg focus:outline-none cursor-pointer hover:bg-white/10 transition-colors",placeholder:"Select Picture"},null,8,$e),_.value?(a(),i("div",Ee,[e("img",{src:_.value,alt:"Preview",class:"w-full h-32 object-cover rounded-lg"},null,8,Fe)])):h("",!0)]),e("button",{onClick:Q,disabled:y.value||!b.value||o.value!=="BANK"&&!f.value,class:"w-full py-3 bg-blue-500/30 hover:bg-blue-500/40 border border-blue-500/50 rounded-lg font-medium text-white transition-all disabled:opacity-50 disabled:cursor-not-allowed"},r(y.value?v(d)("common.processing"):v(d)("deposit.submitButton")),9,Le),e("p",Me,r(v(d)("deposit.waitForReview")),1)])])])]),x.value?(a(),i("div",{key:1,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[6]||(t[6]=L(s=>x.value=!1,["self"]))},[e("div",Ke,[e("div",Pe,[e("h2",qe,r(v(d)("deposit.selectCurrency")),1),e("button",{onClick:t[5]||(t[5]=s=>x.value=!1),class:"text-white/70 hover:text-white"},[...t[11]||(t[11]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",He,[(a(),i(j,null,A(q,s=>e("button",{key:s.value,onClick:n=>V(s.value),class:"w-full flex items-center justify-between p-4 border-b border-white/10 last:border-b-0 hover:bg-white/5 transition-colors"},[e("span",Ie,r(s.label),1),o.value===s.value?(a(),i("svg",Ve,[...t[12]||(t[12]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):h("",!0)],8,ze)),64))])])])):h("",!0),k.value?(a(),i("div",{key:2,class:"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center p-4",onClick:t[8]||(t[8]=L(s=>k.value=!1,["self"]))},[e("div",Je,[e("div",Oe,[t[14]||(t[14]=e("h2",{class:"text-lg font-bold text-white"},"Recharge record",-1)),e("button",{onClick:t[7]||(t[7]=s=>k.value=!1),class:"text-white/70 hover:text-white"},[...t[13]||(t[13]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Qe,[(a(!0),i(j,null,A(C.value,s=>(a(),i("div",{key:s.id,class:"p-4 border-b border-white/10 last:border-b-0"},[e("div",We,[e("div",null,[e("div",Ye,r(s.currency)+" - "+r(z(s.amount)),1),e("div",Ge,r(I(s.created_at)),1)]),e("span",{class:M(["px-2 py-1 rounded text-xs",s.status==="approved"?"bg-green-500/20 text-green-300":s.status==="rejected"?"bg-red-500/20 text-red-300":"bg-yellow-500/20 text-yellow-300"])},r(s.status),3)])]))),128)),C.value.length===0?(a(),i("div",Xe,r(v(d)("deposit.noRecords")),1)):h("",!0)])])])):h("",!0)]))}};export{ot as default};
